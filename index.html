<!DOCTYPE html>
<html>
<head>
    <title>Mars Crypto Conflict - Telegram Mini App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="telegram-web-app-theme-color" content="#8B4513">
    <style>
        /* –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò (—Ç–µ –∂–µ —á—Ç–æ –∏ —Ä–∞–Ω—å—à–µ, –Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö) */
        body {
            margin: 0;
            padding: 0;
            background: #0a0a1a;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* TELEGRAM HEADER SPACER */
        #tg-header-spacer {
            height: 0px; /* Telegram —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç header */
            transition: height 0.3s;
        }
        
        #game-container {
            display: flex;
            flex: 1;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* –¢–ï–õ–ï–ì–†–ê–ú–ú –ü–ê–ù–ï–õ–¨ –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò */
        #tg-auth-panel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
            text-align: center;
        }
        
        #tg-user-info {
            display: none;
            background: rgba(139, 69, 19, 0.3);
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            align-items: center;
            gap: 10px;
        }
        
        .tg-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid gold;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–• */
        @media (max-width: 768px) {
            #game-container {
                flex-direction: column;
            }
            
            #mars-surface {
                flex: 2;
                min-height: 60vh;
            }
            
            #right-panel {
                flex: 1;
                min-width: 100%;
                max-height: 40vh;
                padding: 10px;
            }
            
            .building-btn, .action-btn {
                padding: 10px;
                font-size: 13px;
            }
            
            .stat {
                padding: 8px;
                margin: 4px 0;
            }
            
            .value {
                font-size: 18px;
            }
        }
        
        /* –¢–ï–õ–ï–ì–†–ê–ú–ú –ö–ù–û–ü–ö–ò */
        .tg-btn {
            background: linear-gradient(135deg, #0088cc, #00aced);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 136, 204, 0.3);
        }
        
        .tg-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 136, 204, 0.4);
        }
        
        /* –û–°–¢–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò –û–°–¢–ê–Æ–¢–°–Ø –¢–ê–ö–ò–ú–ò –ñ–ï, –ö–ê–ö –í –ü–†–ï–î–´–î–£–©–ï–ô –í–ï–†–°–ò–ò */
        /* ... */
        
    </style>
</head>
<body>
    <!-- TELEGRAM HEADER SPACER -->
    <div id="tg-header-spacer"></div>
    
    <!-- TELEGRAM AUTH PANEL (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –≤ Telegram) -->
    <div id="tg-auth-panel">
        <div style="font-size: 48px; margin-bottom: 20px;">üöÄ</div>
        <h1 style="color: #FF4500; margin-bottom: 10px;">Mars Crypto Conflict</h1>
        <p style="color: #ccc; margin-bottom: 30px; max-width: 300px;">
            –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ BSC. –î–æ–±—ã–≤–∞–π—Ç–µ —Ä–µ—Å—É—Ä—Å—ã, —Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—ã, —Ç–æ—Ä–≥—É–π—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–ª–æ–Ω–∏—Å—Ç–∞–º–∏!
        </p>
        
        <div id="tg-user-info">
            <img id="tg-user-avatar" src="" class="tg-avatar" alt="–ê–≤–∞—Ç–∞—Ä">
            <div>
                <div id="tg-user-name" style="font-weight: bold;"></div>
                <div id="tg-user-id" style="font-size: 12px; color: #aaa;"></div>
            </div>
        </div>
        
        <button class="tg-btn" onclick="launchInTelegram()">
            ‚ñ∂Ô∏è –ò–≥—Ä–∞—Ç—å –≤ Telegram
        </button>
        
        <div style="margin-top: 20px; font-size: 14px; color: #888;">
            –ò–ª–∏ <a href="javascript:void(0)" onclick="continueWithoutTelegram()" style="color: #00aced; text-decoration: none;">–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</a>
        </div>
        
        <div style="margin-top: 30px; font-size: 12px; color: #666;">
            –î–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram Mini App
        </div>
    </div>
    
    <!-- –û–°–ù–û–í–ù–û–ô –ò–ì–†–û–í–û–ô –ò–ù–¢–ï–†–§–ï–ô–° (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div id="game-container" style="display: none;">
        <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –ü–û–í–ï–†–•–ù–û–°–¢–¨ –ú–ê–†–°–ê -->
        <div id="mars-surface">
            <!-- –ö–∞–º–Ω–∏ –∏ –∑–¥–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –ò–ù–¢–ï–†–§–ï–ô–° -->
        <div id="right-panel">
            <!-- –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ –° –ò–ù–§–û –ò–ì–†–û–ö–ê TELEGRAM -->
            <div id="tg-game-header" style="display: none; margin-bottom: 15px; padding: 10px; background: rgba(139, 69, 19, 0.2); border-radius: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <img id="tg-game-avatar" src="" style="width: 35px; height: 35px; border-radius: 50%; border: 2px solid gold;">
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 14px;" id="tg-game-name"></div>
                        <div style="font-size: 11px; color: #aaa;" id="tg-game-status">–î–æ–±—ã—á–∞ –∞–∫—Ç–∏–≤–Ω–∞</div>
                    </div>
                    <button onclick="showTelegramMenu()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">
                        ‚ãÆ
                    </button>
                </div>
            </div>
            
            <h1>üöÄ Mars Crypto Conflict</h1>
            
            <!-- –û–°–¢–ê–õ–¨–ù–´–ô –ò–ù–¢–ï–†–§–ï–ô–° –ò–ì–†–´ (–≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥) -->
            <div class="stat">
                <div>üí∞ –ë–∞–ª–∞–Ω—Å:</div>
                <div class="value" id="balance">500.00</div>
                <div>MNRT</div>
            </div>
            
            <div class="stat">
                <div>‚õèÔ∏è –î–æ–±—ã—Ç–æ:</div>
                <div class="value" id="mined">0.0000</div>
                <div>MNRT</div>
            </div>
            
            <div class="stat">
                <div>üè¶ –í —Å–µ—Ç–∏:</div>
                <div class="value" id="supply">5,000,000,000</div>
                <div>MNRT</div>
            </div>
            
            <div class="stat">
                <div>‚ö° –≠–Ω–µ—Ä–≥–∏—è:</div>
                <div class="value" id="energy">0/0</div>
                <div>–ø—Ä–æ–∏–∑–≤./–ø–æ—Ç—Ä–µ–±.</div>
            </div>
            
            <button class="building-btn" onclick="startBuilding('base')" id="btn-base">
                üè† –ë–∞–∑–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞<br>
                <small>100 MNRT | –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞</small>
            </button>
            
            <button class="building-btn" onclick="startBuilding('mining')" id="btn-mining">
                ‚õèÔ∏è –ë—É—Ä–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞<br>
                <small>200 MNRT | –î–æ–±—ã–≤–∞–µ—Ç 0.001 MNRT/—Å–µ–∫ | 2‚ö° —ç–Ω–µ—Ä–≥–∏–∏</small>
            </button>
            
            <button class="building-btn" onclick="startBuilding('power')" id="btn-power">
                ‚ö° –°–æ–ª–Ω–µ—á–Ω–∞—è —ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏—è<br>
                <small>200 MNRT | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 5‚ö° —ç–Ω–µ—Ä–≥–∏–∏</small>
            </button>
            
            <button class="action-btn" onclick="collectResources()">
                üí∞ –°–æ–±—Ä–∞—Ç—å –¥–æ–±—ã—Ç—ã–µ —Ä–µ—Å—É—Ä—Å—ã
            </button>
            
            <div id="building-list">
                <h3>üèóÔ∏è –ú–æ–∏ –∑–¥–∞–Ω–∏—è:</h3>
                <div id="buildings-container"></div>
            </div>
            
            <!-- –î–û–ë–ê–í–õ–Ø–ï–ú –ü–£–°–¢–û–¢–£ –î–õ–Ø –°–ö–†–û–õ–õ–ê -->
            <div style="height: 50px;"></div>
            
            <div id="message"></div>
            
            <!-- TELEGRAM –§–£–¢–ï–† -->
            <div id="tg-footer" style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #333; text-align: center; font-size: 12px; color: #888;">
                <div>–ò–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Telegram Mini App</div>
                <div style="margin-top: 5px;">
                    <button onclick="shareGame()" style="background: #0088cc; color: white; border: none; border-radius: 15px; padding: 8px 15px; font-size: 12px; cursor: pointer;">
                        üì¢ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- TELEGRAM WEB APP SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script>
        // ============================
        // TELEGRAM WEB APP –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ============================
        let TelegramWebApp = null;
        let tgUser = null;
        let isTelegram = false;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω—ã –ª–∏ –º—ã –≤ Telegram
        function detectTelegram() {
            try {
                if (window.Telegram && window.Telegram.WebApp) {
                    TelegramWebApp = window.Telegram.WebApp;
                    isTelegram = true;
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram Web App
                    TelegramWebApp.ready();
                    TelegramWebApp.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
                    
                    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ –ø–æ–¥ –Ω–∞—à—É –∏–≥—Ä—É
                    TelegramWebApp.setHeaderColor('#8B4513');
                    TelegramWebApp.setBackgroundColor('#0a0a1a');
                    
                    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (TelegramWebApp.initDataUnsafe && TelegramWebApp.initDataUnsafe.user) {
                        tgUser = TelegramWebApp.initDataUnsafe.user;
                        console.log('Telegram user detected:', tgUser);
                        showTelegramUser();
                        hideAuthPanel();
                        showGame();
                    } else {
                        console.log('No Telegram user data');
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
                    }
                    
                    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –º–µ–Ω—é
                    setupTelegramMenu();
                    
                    return true;
                }
            } catch (error) {
                console.error('Telegram Web App error:', error);
            }
            return false;
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ Telegram
        function showTelegramUser() {
            if (!tgUser) return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –∏ –∏–º—è –≤ –ø–∞–Ω–µ–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            if (tgUser.photo_url) {
                document.getElementById('tg-user-avatar').src = tgUser.photo_url;
            }
            document.getElementById('tg-user-name').textContent = 
                tgUser.first_name + (tgUser.last_name ? ' ' + tgUser.last_name : '');
            document.getElementById('tg-user-id').textContent = 'ID: ' + tgUser.id;
            document.getElementById('tg-user-info').style.display = 'flex';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –∏ –∏–º—è –≤ –∏–≥—Ä–æ–≤–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
            if (tgUser.photo_url) {
                document.getElementById('tg-game-avatar').src = tgUser.photo_url;
            }
            document.getElementById('tg-game-name').textContent = 
                tgUser.first_name + (tgUser.username ? ' (@' + tgUser.username + ')' : '');
            document.getElementById('tg-game-header').style.display = 'block';
        }
        
        // –°–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function hideAuthPanel() {
            document.getElementById('tg-auth-panel').style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function showGame() {
            document.getElementById('game-container').style.display = 'flex';
            
            // –ï—Å–ª–∏ –≤ Telegram, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º Telegram —Ñ—É—Ç–µ—Ä
            if (isTelegram) {
                document.getElementById('tg-footer').style.display = 'block';
            } else {
                document.getElementById('tg-footer').style.display = 'none';
                document.getElementById('tg-game-header').style.display = 'none';
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
            initGame();
        }
        
        // –ó–∞–ø—É—Å–∫ –≤ Telegram
        function launchInTelegram() {
            const botUsername = 'MarsC–°_–ò—â–µ'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ username –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
            const appUrl = window.location.href;
            const telegramUrl = `https://t.me/${botUsername}?startapp=${encodeURIComponent(appUrl)}`;
            
            window.open(telegramUrl, '_blank');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            showMessage('–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Å—ã–ª–∫—É –≤ Telegram –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã', 'success');
        }
        
        // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ Telegram
        function continueWithoutTelegram() {
            hideAuthPanel();
            showGame();
            showMessage('üöÄ –†–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã.', 'success');
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ–Ω—é Telegram
        function setupTelegramMenu() {
            if (!TelegramWebApp) return;
            
            // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
            TelegramWebApp.MainButton.setText('üìä –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å');
            TelegramWebApp.MainButton.onClick(showProfile);
            TelegramWebApp.MainButton.show();
            
            // Back Button
            TelegramWebApp.BackButton.onClick(goBack);
        }
        
        function showTelegramMenu() {
            if (!TelegramWebApp) return;
            
            TelegramWebApp.showPopup({
                title: '–ú–µ–Ω—é –∏–≥—Ä—ã',
                message: '–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:',
                buttons: [
                    {id: 'profile', type: 'default', text: 'üìä –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å'},
                    {id: 'share', type: 'default', text: 'üì¢ –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π'},
                    {id: 'support', type: 'default', text: 'üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞'},
                    {type: 'cancel'}
                ]
            }, function(buttonId) {
                if (buttonId === 'profile') showProfile();
                if (buttonId === 'share') shareGame();
                if (buttonId === 'support') showSupport();
            });
        }
        
        function showProfile() {
            if (!tgUser) return;
            
            const profileText = `
üë§ –ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞:
–ò–º—è: ${tgUser.first_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
ID: ${tgUser.id}
–ë–∞–ª–∞–Ω—Å: ${gameState.balance.toFixed(2)} MNRT
–î–æ–±—ã—Ç–æ –≤—Å–µ–≥–æ: ${gameState.totalMinedAllTime.toFixed(4)} MNRT
–ó–¥–∞–Ω–∏—è: ${gameState.buildings.length} —à—Ç.
            `;
            
            showMessage(profileText, 'success');
        }
        
        function shareGame() {
            const shareText = encodeURIComponent(
                `üöÄ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ Mars Crypto Conflict!\n` +
                `–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–µ BSC\n` +
                `–î–æ–±—ã–≤–∞–π —Ä–µ—Å—É—Ä—Å—ã, —Å—Ç—Ä–æ–π –±–∞–∑—ã, —Ç–æ—Ä–≥—É–π —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–ª–æ–Ω–∏—Å—Ç–∞–º–∏!`
            );
            
            const shareUrl = isTelegram ? 
                `https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${shareText}` :
                `https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${shareText}`;
            
            window.open(shareUrl, '_blank');
            
            showMessage('–°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
        }
        
        function showSupport() {
            const supportUrl = 'https://t.me/MarsCryptoSupport'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –∫–∞–Ω–∞–ª –ø–æ–¥–¥–µ—Ä–∂–∫–∏
            window.open(supportUrl, '_blank');
        }
        
        function goBack() {
            // –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
            showMessage('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é –∏–≥—Ä—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏', 'success');
        }
        
        // ============================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ (–≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥, –Ω–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏)
        // ============================
        function initGame() {
            console.log('üöÄ –ò–≥—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞! Telegram: ' + isTelegram);
            
            // –ï—Å–ª–∏ –≤ Telegram, –ª–æ–≥–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (tgUser) {
                console.log('–ò–≥—Ä–æ–∫:', tgUser.first_name, 'ID:', tgUser.id);
                
                // –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±—ç–∫–µ–Ω–¥–∞
                if (isTelegram) {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    // saveUserToBackend(tgUser.id, tgUser.first_name);
                }
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ú–∞—Ä—Å–∞
            generateMarsSurface();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ —Ü–∏–∫–ª—ã
            gameState.lastUpdate = Date.now();
            setInterval(updateMining, 1000);
            
            // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            if (isTelegram && tgUser) {
                showMessage(`üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –ú–∞—Ä—Å, ${tgUser.first_name}!`, 'success');
            } else {
                showMessage('üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –ú–∞—Ä—Å! –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–æ–±—ã—á–∏.', 'success');
            }
        }
        
        // ============================
        // –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ì–†–´ (–≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥)
        // ============================
        // ... (–≤–µ—Å—å –≤–∞—à –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–≥—Ä–æ–≤–æ–π –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–¥–µ—Å—å) ...
        
        // –í–ê–ñ–ù–û: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (generateMarsSurface, startBuilding, 
        // updateMining, updateUI –∏ —Ç.–¥.) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã —Å—é–¥–∞
        
    </script>
    
    <!-- –û–°–ù–û–í–ù–û–ô –ò–ì–†–û–í–û–ô –°–ö–†–ò–ü–¢ (–≤—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ –≤–µ—Å—å –≤–∞—à –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏) -->
    <script>
        // ============================
        // –ö–û–ù–°–¢–ê–ù–¢–´ –ò–ì–†–´ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï)
        // ============================
        const CONFIG = {
            MINING_RATE: 0.001,
            TOTAL_SUPPLY: 5000000000,
            BUILDING_COSTS: {
                base: 100,
                mining: 200,
                power: 200
            },
            ENERGY_CONSUMPTION: {
                base: 0,
                mining: 2,
                power: 0
            },
            ENERGY_PRODUCTION: {
                base: 0,
                mining: 0,
                power: 5
            },
            UPKEEP_COSTS: {
                base: 0.0002,
                mining: 0.0002,
                power: 0.0002
            }
        };

        // ============================
        // –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´
        // ============================
        let gameState = {
            balance: 500.0,
            mined: 0.0,
            supply: CONFIG.TOTAL_SUPPLY,
            totalMinedAllTime: 0.0,
            buildings: [],
            placingBuilding: null,
            nextId: 1,
            hasBase: false,
            energy: { production: 0, consumption: 0 },
            upkeepDebt: 0,
            lastUpdate: Date.now()
        };

        // ============================
        // –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–û–í–ï–†–•–ù–û–°–¢–ò –ú–ê–†–°–ê
        // ============================
        function generateMarsSurface() {
            const surface = document.getElementById('mars-surface');
            surface.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const texture = document.createElement('div');
                texture.style.position = 'absolute';
                texture.style.left = Math.random() * 100 + '%';
                texture.style.top = Math.random() * 100 + '%';
                texture.style.width = Math.random() * 100 + 50 + 'px';
                texture.style.height = Math.random() * 100 + 50 + 'px';
                texture.style.background = `rgba(${
                    Math.floor(139 + Math.random() * 40)
                }, ${
                    Math.floor(69 + Math.random() * 30)
                }, ${
                    Math.floor(19 + Math.random() * 20)
                }, ${Math.random() * 0.3 + 0.1})`;
                texture.style.borderRadius = '50%';
                surface.appendChild(texture);
            }
            
            for (let i = 0; i < 30; i++) {
                const rock = document.createElement('div');
                rock.className = 'rock';
                rock.style.width = Math.random() * 30 + 15 + 'px';
                rock.style.height = Math.random() * 30 + 15 + 'px';
                rock.style.left = Math.random() * 95 + '%';
                rock.style.top = Math.random() * 95 + '%';
                const darkness = Math.floor(80 + Math.random() * 40);
                rock.style.background = `rgb(${darkness}, ${darkness}, ${darkness})`;
                surface.appendChild(rock);
            }
            
            renderBuildings();
        }

        // ... (–í–°–¢–ê–í–¨–¢–ï –í–ï–°–¨ –û–°–¢–ê–í–®–ò–ô–°–Ø –ö–û–î –ò–ì–†–´ –ó–î–ï–°–¨) ...

        // ============================
        // –ó–ê–ü–£–°–ö –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´
        // ============================
        window.onload = function() {
            console.log('üåå Mars Crypto Conflict –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Telegram
            const inTelegram = detectTelegram();
            
            if (!inTelegram) {
                // –ù–µ –≤ Telegram - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                document.getElementById('tg-auth-panel').style.display = 'flex';
            }
            // –ï—Å–ª–∏ –≤ Telegram, detectTelegram —É–∂–µ –∑–∞–ø—É—Å—Ç–∏—Ç –∏–≥—Ä—É
        };
    </script>
</body>

</html>
